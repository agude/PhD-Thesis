\chapter{Analysis}
\label{chapter:analysis}

\section{Uncertainties}
\label{sec:uncertainties}

\TODO{Intro?}

\subsection{Statistical Uncertainties}
\label{ssec:stat_uncertainty}

The statistical uncertainties due to the number of data events are propagated
through the unfolding method, as discussed in
\SEC~\ref{ssec:unfolding_statistical_uncertainties}. This uncertainty is
ranges from 0.26 to 1.21\% for both the absolute and normalized cross section
measurement. It is one of the dominant uncertainties for the normalized cross
section measurement.

\subsection{Statistical Uncertainties from the Monte Carlo Samples}
\label{ssec:mc_stat_uncertainty}

The \MADGRAPH signal MC sample has fewer events which pass our final selection
than there are events in the data. This sample is used to unfold the data and
so its statistical uncertainty affects the final measurement. The affect of the
statistical uncertainty on the bin migration matrix is propagated through to
the final result via the use of toy MC, detailed in
\SEC~\ref{ssec:unfolding_statistical_uncertainties}. The uncertainty found with
this method is 0.1 to 0.2\% for both the absolute and normalized cross section
measurements.

In addition to affecting the unfolding, the low number of events in the MC
affects the efficiency correction discussed in \SEC~\ref{ssec:eff_correction}
and shown in \FIG~\ref{fig:average_efficiencies}. These uncertainties vary from
0.3 to 1.3\% for both the absolute and normalized cross section measurements.

These two sources of uncertainty are measured separately. The finally
uncertainty due to the statistical uncertainties from the \MADGRAPH signal MC
sample is the sum in quadrature of both sources. This combined uncertainty is
the dominant uncertainty for the normalized cross section measurement, having a
slightly larger effect in each \phistar bin than the statistical uncertainty
due to the data.

\subsection{Luminosity Uncertainty}
\label{ssec:lumi_uncertainty}

The integrated luminosity is measured at CMS using the occupancy in the
pixel detector during minimum-bias events \cite{cms_lumi_2013}. This luminosity
measurement is calibrated by using van der Meer scans---a method to measure the
beam size in which the two beams are displaced and then ``swept'' across each
other as the offset is reduced \cite{vandermeer_1968}.

The integrated luminosity for the run period considered in this analysis is
known to \LumiUncertainty. This uncertainty is taken to be fully correlated
bin-by-bin in \phistar for the absolute cross section measurement, where it is
by far the dominant uncertainty. The luminosity cancels in the normalized
cross section measurement and so the uncertainty only affects the background
subtraction. This effect is negligible compared to the uncertainty already
present due to the background subtraction, which is discussed in
\SEC~\ref{ssec:background_subtraction_uncertainty}. The large uncertainty on
the luminosity is the primary motivation behind making a normalized cross
section measurement.

\subsection{Pileup Uncertainty}
\label{ssec:pileup_uncertainty}

As discussed in \SEC~\ref{ssec:monte_carlo}, the high beam intensity at the LHC
leads to multiple proton-proton interactions at each bunch crossing. This is
modeled in MC by overlaying multiple simulated minimum-bias events on top of
each simulated event. The distribution of pileup in MC is reweighted to match
the data distribution based on the calculated instantaneous luminosity and the
inelastic proton-proton cross section. The uncertainty due to this reweighting
process is calculated by varying the inelastic cross section by plus and minus
5\%, recalculating the data distribution of pileup, and reweighting to the MC
samples to match this new distribution. The full analysis is then performed
with these MC samples and the differences between the \phistar distributions is
taken as a systematic uncertainty. The pileup uncertainty for the absolute
cross section measurement ranges from 0.21 to 0.58\%, while the uncertainty for
the normalized cross section measurement is between $< 0.01$ and 0.64\%.

\subsection{Trigger, Reconstruction, and Identification Scale Factors Uncertainty}
\label{scale_factor_uncertainty}

Differences between the MC and data are corrected for using scale factors.
Three different sets of scale factors are used to reweight the MC samples:
trigger scale factors (discussed in \SEC~\ref{ssec:sf_trigger}), reconstruction
scale factors (discussed in \SEC~\ref{ssec:sf_reconstruction}), and
identification scale factors (discussed in \SEC~\ref{ssec:sf_id}).

In all three cases, the uncertainties on the scale factors are propagated
through to the final measurement using 500 toy MC variations. In this method,
every toy is constructed by drawing each scale factor from a Gaussian
probability distribution with its mean set to nominal value of the scale factor
and its width set to the quadrature sum of the uncertainties on the scale
factor. Each toy is then used to weight the MC samples used in this analysis,
and the full analysis is performed with that newly weighted sample. The
uncertainty on the final result due to one of the three types of scale factors
is taken to be defined by the central 68.2\% of results from the toys.

This procedure for propagating the uncertainty is performed independently for
each of the three types of scale factors. The total uncertainty due to the
scale factors is the sum in quadrature of the three results. For the absolute
cross section measurement this uncertainty is about 0.4\%, while for the
normalized cross section measurement it ranges from 0.02 to 0.35\%.

\subsection{\texorpdfstring{\pt}{PT} Scale Uncertainty}
\label{ssec:pt_scale_uncertainty}

One of the advantages of the \phistar variable is that it is not computed using
the momentum of the electrons and instead uses only the angles between them,
which are generally better measured. This makes \phistar less sensitive to any
potential problems with the \pt measurement of electrons.

However, the measurement of the \pt of the electrons is used to determine which
events are included in our sample. Therefore, a shift in the \pt scale of the
detector will either add or remove events that have electrons near the \pt
selection requirement boundaries. To determine the uncertainty due to the \pt
scale, we vary the \pt values of all of the electron up and down by 0.3\%,
which is a conservative estimate of the uncertainty on the \pt scale. The
largest difference in each \phistar bin between the nominal result and the
results with the modified \pt scale is taken as the uncertainty in that bin.
The uncertainty due to the \pt scale for the absolute cross section measurement
is 0.07 to 0.17\%, while the uncertainty for the normalized cross section
measure is $< 0.01$ to 0.10\%.

\subsection{Background Subtraction Uncertainty}
\label{ssec:background_subtraction_uncertainty}

The background subtraction, which is discussed in \SEC~\ref{sec:background},
deals with three separate categories of backgrounds. The uncertainty in
each category is determined with a different method, and these uncertainties
are added in quadrature to determine the total uncertainty due to the
background subtraction.

The first category consists of the various backgrounds with two independent
decay chains each of which can produce a lepton: $\ttbar$, $\W\W$,
$\DYtotautau$, $t\W$, and $\tbar\W$. The contributions from these backgrounds
are estimated by using an \emu control sample as discussed in
\SEC~\ref{ssec:emu_sample}. The uncertainty from the scale factors derived
using this method are propagated through to the final result using 500 toy MC
variations. For each variation, the scale factors are randomly drawn from a
Gaussian distribution with mean equal to the nominal value of that scale factor
and width equal to the uncertainty on the scale factor. Each toy is then used
to weight the background MC samples and the full which are then used to perform
the background subtraction. The full analysis is then run with the newly
background-subtracted data samples. The uncertainty due to the subtraction of
this category of background for each bin in \phistar is defined by the spread
of the central 68.2\% values obtained by the toys.

The second category consists of the backgrounds with a real \Z boson: $\Z\Z$
and $\W\Z$. For these samples, the uncertainty is calculated by taking a
correlated 20\% uncertainty on the theoretical cross section.

The third and final category consists of the \QCDjets and \wjets
backgrounds. The method of estimating this background is discussed in
\SEC~\ref{ssec:qcd_background}. Instead of taking the uncertainties from the
fit, which would not account for any systematics in the method used, a
conservative 100\% uncertainty is assigned to this category.

The uncertainty due to the background subtraction for the absolute cross
section measurement varies from 0.02 to 0.64\%, and from 0.03 to 0.59\% in the
normalized cross section measurement.

\subsection{PDF and Cross Section Uncertainties}
\label{ssec:pdf_uncertainties}

As discussed in \TODO{\SEC~\ref{} Link to theory section}, the kinematics of
the \Z boson depend on the internal composition and kinematics of the protons
as they collide. The reconstructed \phistar distribution is therefore dependent
on the PDFs used to generate the signal MC sample.

The uncertainty due to this choice of PDF is calculated following the
recommendation of \PDFforLHC working group for the \POWHEG MC signal sample.
\PDFWeightProducer is used to reweight the \POWHEG sample using the \CTten PDF
set. A total of \num{26} different pairs of weights are used by the tool to
fully account for the uncertainty inherent in the PDF set; these weights are
provided by the \CTten collaboration specifically for this purpose. Each pair
of weights consists of a variation of a PDF parameter, with one weight
corresponding to adjusting the parameter up and the other weight to down. Each of
these weights are used to reweight the \POWHEG sample, and the analysis is
performed with this newly weighted sample.
The uncertainty due to each weight is taken to be the difference with the
nominal \phistar distribution. Two uncertainties are calculated: the
one due to all of the upward parameter adjustments, and one to all the downward
parameter adjustments added in quadrature. The largest of these for each
\phistar bin is taken as the total uncertainty.

For the \MADGRAPH MC signal sample, which is an LO sample generated with a LO
PDF, the uncertainties can not be calculated in this manner. Instead, the PDF
includes an uncertainty on the cross section as calculated by \FEWZ which is
used to scale the sample. This uncertainty is propagated through the analysis
be reweighting the \MADGRAPH with this uncertainty both added and subtracted.
The difference in the final \phistar distribution is taken as the uncertainty
due to the \FEWZ cross section. This uncertainty is the dominant uncertainty
from the \MADGRAPH sample.

\subsection{Final State Radiation Uncertainties}
\label{ssec:fsr_uncertainties}

FSR, where an electron radiates a photon, is discussed in
\SEC~\ref{sec:electron_dressing}. These photons can affect the reconstruction
of the \Z, but this is taken into account during the unfolding as discussed in
\SEC~\ref{sec:unfolding}. Hence, uncertainties in the modeling of FSR affect
the unfolding and the final measurement.

The uncertainty is calculated using the \FSRWeightProducer, which augments the
\PYTHIA QED calculation with exact $\BigO{\alpha}$ and $\alpha(\pt^{2})$
couplings and reweights the MC sample as if it had been produced with these
calculations from the start. The effect of this reweighting on the final
\phistar distribution is $\le 0.34\%$ for the absolute cross section
measurement and $\le 0.03\%$ for the normalized cross section measurement.

%\subsection{Electron Angular Position Uncertainty}
%
%\TODO{What has Nicole seen in new tests?}
%
%Since \phistar depends on the angles between the two electrons, it is sensitive
%to mismeasurement of these angles. As discussed in
%\SEC~\ref{sec:electron_reconstruction}, the position of a reconstructed
%electron comes from the tracker, and therefore misalignment of the tracker
%would lead to a systematic uncertainty on the angle measurement. The magnitude
%of this systematic is estimated by using the position of the ECAL supercluster
%associated with the electron to calculate the electron's position instead of
%using the track. The new supercluster-only position is then used to calculate a
%new \phistarSC that does not depend on the alignment of the tracker.
%
%The position of the supercluster does not take into account the amount the
%bending of the electron due to the magnetic field. While $\eta$ is unchanged by
%the pretense of the field, $\phi$ is changed. A correction is applied to $\phi$
%to find the angle at the interaction point, $\phizero$, based on the angle of
%the supercluster, $\phisc$. This correction is given by
%\EQ~\ref{eq:b_field_correction} where $q$ is the charge of the electron, \pt is
%the transverse momentum of the electron, $B$ is the magnitude of the magnetic
%field, and \Reffective is the effective radius of ECAL as a function of $\eta$
%and $\theta$ as given in \EQ~\ref{eq:effective_radius}. The charge and momentum
%come from the electron matched to the supercluster, and although they are
%determined in combination with the tracker, they are far less susceptible to
%the small scale misalignments of the tracker that we are considering.
%
%\begin{equation}\label{eq:b_field_correction}
%    \sin \left( \phisc - \phizero \right)
%    =
%    - \Reffective \frac{q B}{2 \pt}
%\end{equation}
%
%\begin{equation}\label{eq:effective_radius}
%    \Reffective
%    =
%    \left\{
%        \begin{array}{ll}
%            1.29 \meters & \text{if } |\eta| < 1.4442 \\
%            3.14 \meters \times \tan \left(\coord{\theta}\right) & \text{otherwise}
%        \end{array}
%    \right.
%\end{equation}
%
%The resulting \phistarSC distribution is compatible within statistical
%uncertainties with the \phistar distribution and so no systematic uncertainty
%is assigned for the angular position.
%
%\TODO{Plot of \phistar vs \phistarSC?}

\subsection{Uncertainty from Four Vector Corrections}
\label{four_vector_uncertainty}

The \mee distribution in the \MADGRAPH signal MC sample does not precisely
match the distribution in data, as seen in \FIG~\ref{fig:z_mass}. This
discrepancy remains even after applying the various energy and momentum
corrections to the electrons discussed in \SEC~\ref{sec:corrections}. In order
to determine the effect this has on the final measurement, the \MADGRAPH signal
MC sample is reweighted to remove this difference. The ratio between the
nominal \phistar value and the value derived after this reweighting is shown in
\FIG~\ref{fig:z_mass_reweighted}. The circular points show the ratio of the
reconstructed \phistar distributions, while the square points show the ratio of
the generated \phistar distributions. The errors are binomial. Most of the
points are consistent with \num{1}, and so no systematic uncertainty is
assigned for this disagreement.

\begin{figure}[!htbp]
    \centering
    \includegraphics[width=\textwidth]{figures/ZMass_reweighed.pdf}
    \caption[
        The ratio of \phistar in \MADGRAPH before and after reweighting to
        remove the differnce in the \mee distribution between MC and data.
    ]{
        The ratio of \phistar in \MADGRAPH before and after reweighting to
        remove the difference in the \mee distribution between MC and data seen
        in \FIG~\ref{fig:z_mass}. The circular points are the ratio in the
        reconstructed quantity, while the square points are the ratio in the
        generated quantity. The uncertainties are binomial.
    }
    \label{fig:z_mass_reweighted}
\end{figure}

\TODO{Reweighting the \Z \pt plot?}

\section{Uncertainty Tables}

Tables summarizing the values of the various uncertainties as well as the total
uncertainty in each bin of \phistar for both the data and for the \MADGRAPH
signal MC sample are given below. The data tables,
\TABS~\ref{tab:sys_uncert_abs} and \ref{tab:sys_uncert_norm}, contain the
following columns:

\begin{description}[noitemsep]

    \item[\phistar Range:] \hfill \\
        The range of \phistar values included in the bin.

    \item[Total Uncertainty (Total):] \hfill \\
        The quadrature sum of the all of the uncertainties.

    \item[Statistical Uncertainty (Stat.):] \hfill \\
        The uncertainty due to the limited number of events in the data, as
        discussed in \SEC~\ref{ssec:stat_uncertainty}.

    \item[Total Systematic Uncertainty (Total Syst.):] \hfill \\
        The quadrature sum of all of the systematic uncertainties including,
        for the absolute distribution, the luminosity uncertainty of
        \LumiUncertainty.

    \item[Monte Carlo Statistical Uncertainty (MC Stat.):] \hfill \\
        The uncertainty due to the limited number of events in the MC samples,
        as discussed in \SEC~\ref{ssec:mc_stat_uncertainty}.

    \item[Pileup Uncertainty (Pileup):] \hfill \\
        The uncertainty due to the pileup reweighting, as discussed in
        \SEC~\ref{ssec:pileup_uncertainty}.

    \item[Scale Factor Uncertainty (SF):] \hfill \\
        The uncertainty due to the scale factors, as discussed in
        \SEC~\ref{scale_factor_uncertainty}.

    \item[\pt Scale Uncertainty (\pt Scale):] \hfill \\
        The uncertainty due to \pt scale, as discussed in
        \SEC~\ref{ssec:pt_scale_uncertainty}.

    \item[Background Subtraction Uncertainty (Bkg.):] \hfill \\
        The uncertainty due to background subtraction, as discussed in
        \SEC~\ref{ssec:background_subtraction_uncertainty}.

\end{description}

The MC tables, \TABS~\ref{tab:madgraph_uncert_abs}, \ref{tab:powheg_uncer_abs},
\ref{tab:madgraph_uncert_norm}, and \ref{tab:powheg_uncer_norm}, have the
following columns:

\begin{description}[noitemsep]

    \item[\phistar Range:] \hfill \\
        The range of \phistar values included in the bin.

    \item[Total Uncertainty (Total):] \hfill \\
        The quadrature sum of the all of the uncertainties.

    \item[Statistical Uncertainty (Stat.):] \hfill \\
        The uncertainty due to the limited number of events in the MC sample.

    \item[Parton Density Function (PDF):] \hfill \\
        The uncertainty due to choice of PDF used to generate the \POWHEG MC,
        as discussed in \SEC~\ref{ssec:pdf_uncertainties}.

    \item[Theoretical Cross Section Uncertainty (Cross Section):] \hfill \\
        The uncertainty in the theoretical cross section of the \MADGRAPH MC,
        as discussed in \SEC~\ref{ssec:pdf_uncertainties}.

    \item[Final State Radiation Uncertainty (FSR):] \hfill \\
        The uncertainty due to the modeling of FSR, as discussed in
        \SEC~\ref{ssec:fsr_uncertainties}.

\end{description}

% Absolute

% tab:sys_uncert_abs
\input{tables/data_uncertainty_absolute.tex}
% tab:madgraph_uncert_abs
\input{tables/madgraph_uncertainty_absolute.tex}
% tab:powheg_uncert_abs
\input{tables/powheg_uncertainty_absolute.tex}


% Normalized

% tab:sys_uncert_norm
\input{tables/data_uncertainty_normalized.tex}
% tab:madgraph_uncert_norm
\input{tables/madgraph_uncertainty_normalized.tex}
% tab:powheg_uncert_norm
\input{tables/powheg_uncertainty_normalized.tex}
