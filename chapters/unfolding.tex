\chapter{Unfolding}
\label{chatper:unfolding}

Particle detectors are incredibly sophisticated machines designed to make
precise measurements of the various decay products created during the
collisions. However, there are physical limitations that prevent a perfect
measurement from being made. The finite energy, momentum, and position
resolution of the various subdetectors impose limitations on the final
measurements. In order to allow our measurement to be compared to theoretical
predictions, we correct for these detector effects with a process known as
unfolding.

We unfold in two steps: first the data are unfolded to correct for bin
migration, second we correct for the imperfect efficiency of the trigger and
reconstruction. The data are unfolded against the three definitions of
generator level electrons: born, dressed, and bare as described in
\SEC~\ref{sec:electron_dressing}. Results in this chapter are shown with
dressed electrons, born and bare electrons are given in \APP\TODO{Born, Bare
Appendix}.

\section{Bin Migration}
\label{sec:bin_migration}

The finite resolution of CMS's angular position measurements leads to a finite
resolution of the reconstructed \phistar distribution. Events which at the
generator level would have ended up in a certain \phistar bin may instead
migrate to one of the neighboring bins.

MC events are used to create a response matrix that describes how generator
level events are reconstructed in CMS. Through unfolding this matrix is
inverted, allowing us to transform the data to remove the undesired bin
migration. This matrix is shown in \FIG~\ref{fig:bin_migration_matrix}. The
amount of bin migration, as measured by the off-diagonal elements, is 5.5\%.

\TODO{Bin migration plot that is the input to \RooUnfold
\label{fig:bin_migration_matrix}.}

\RooUnfold is used to perform the unfolding \cite{adye_2011}. It implements
Bayes' theorem as described in \cite{dagostini_1995}, and iteratively applies
it to invert the response matrix. \RooUnfold uses a limited number of
iterations in order to terminate the algorithm before finding the true (but
highly unstable) inverse. Four iterations are used in this analysis.

\subsection{Closure Tests}

This unfolding procedure was tested in several ways using the two signal MC
samples discussed in \SEC~\ref{ssec:monte_carlo}. First, the reconstructed
\phistar distributions from the \MADGRAPH and \POWHEG sample were unfolded
using their own generator level quantities and compared to their generator
level \phistar distributions. The results of this test are shown
\FIG~\ref{fig:unfolded_vs_true_in_mc}.

\TODO{Figure 8 from the AN \label{fig:unfolded_vs_true_in_mc}}

Second, each MC signal sample was also divided into two independent halves.
The reconstructed \phistar distribution in each half was unfolded using the
generator level quantities from the other half. The two halves were then
compared to each other. The results of this test are shown in
\FIG~\ref{fig:half_vs_half_unfolding}.

\TODO{Figure 9 from the AN \label{fig:half_vs_half_unfolding}}

Third and finally, the reconstructed \phistar distribution in the \MADGRAPH
MC was unfolded with the generator level quantities from the \POWHEG sample and
vice versa. The results of this test are shown in
\FIG~\ref{fig:cross_mc_unfolding}.

\TODO{Figure 10 from the AN \label{fig:cross_mc_unfolding}}

In most cases the results are consistent within the assigned statistical error
bars. However, in the case of the \MADGRAPH sample unfolded with \POWHEG, there
is disagreement between in the low \phistar bins. This is due \RooUnfold under
estimating the uncertainties, as discussed below.

\subsection{Statistical Uncertainties}
\label{ssec:unfolding_statistical_uncertainties}

The uncertainties shown in \FIGS~\ref{fig:unfolded_vs_true_in_mc},
\ref{fig:half_vs_half_unfolding}, and \ref{fig:cross_mc_unfolding} are the
statistical uncertainties returned by \RooUnfold. These uncertainties only take
the number of events in the reconstructed distribution into account; they do
not account for the number of generator level events used to create the
response matrix.

\section{Efficiency Correction}

Not every event which should be detected by CMS is. Some events are lost at
each stage of event selection and reconstruction. These lost events must be
corrected for in order to accurately compare our results to theory. We
therefore apply corrections for the reconstruction efficiency, the electron ID
efficiency, and the trigger efficiency.

The efficiency corrections are applied after the bin migration corrections. The
correction factors are derived for each \phistar bin using the \Ztoee \MADGRAPH
sample discussed in \SEC~\ref{ssec:monte_carlo}. Two sets of events are
selected. The first set, the ``acceptance set'', is created by applying the
acceptance definition discussed in \SEC~\ref{sec:acceptance}) to the generator
level quantities in the MC. The second set, the ``final selection set'', is
created by selecting MC events by applying the full analysis selection to the
reconstructed level quantities in the MC. The efficiency in each \phistar bin
is calculated by counting the number of events in the ``final selection set''
in a bin, and dividing by the number of events in the same bin in the
``acceptance set''. This gives us an average efficiency composed of all the
efficiencies of the events in the bin.

The main advantage of using this average efficiency instead of correcting each
event's efficiency individually is that any correlations between the various
efficiencies are automatically taken into account in this process.

\TODO{Add plots from AN when they're finalized.}
